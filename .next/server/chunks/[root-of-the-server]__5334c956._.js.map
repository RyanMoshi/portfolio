{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 145, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ryanm/portfolio-git/app/api/contact/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\r\nimport nodemailer from \"nodemailer\";\r\n\r\nconst NOTIFY_EMAIL = \"ryanmoshi77@gmail.com\";\r\n// IMPORTANT: Emails can't load images from localhost. Default to your live site,\r\n// and allow overriding via env SITE_URL when deploying elsewhere.\r\nconst SITE_URL = process.env.SITE_URL || \"https://ryan-moshi-portfolio.lindy.site\";\r\nconst SMTP_HOST = process.env.SMTP_HOST || \"smtp.gmail.com\";\r\nconst SMTP_PORT = Number(process.env.SMTP_PORT || 587);\r\nconst SMTP_USER = process.env.SMTP_USER || \"\";\r\nconst SMTP_PASS = process.env.SMTP_PASS || \"\";\r\nconst FROM_EMAIL = process.env.MAIL_FROM || \"Ryan Moshi <noreply@your-domain.com>\";\r\n\r\nasync function sendEmail(to: string, subject: string, html: string) {\r\n  if (!SMTP_USER || !SMTP_PASS) {\r\n    console.error(\"SMTP Configuration Check:\");\r\n    console.error(\"SMTP_USER:\", SMTP_USER ? \"Set\" : \"Missing\");\r\n    console.error(\"SMTP_PASS:\", SMTP_PASS ? \"Set\" : \"Missing\");\r\n    console.error(\"SMTP_HOST:\", SMTP_HOST);\r\n    console.error(\"SMTP_PORT:\", SMTP_PORT);\r\n    throw new Error(\"SMTP not configured. Set SMTP_USER and SMTP_PASS in .env.local\");\r\n  }\r\n  const transporter = nodemailer.createTransport({\r\n    host: SMTP_HOST,\r\n    port: SMTP_PORT,\r\n    secure: SMTP_PORT === 465, // true for 465, false for other ports\r\n    auth: { user: SMTP_USER, pass: SMTP_PASS },\r\n    tls: {\r\n      rejectUnauthorized: false // Allow self-signed certificates\r\n    }\r\n  });\r\n  await transporter.sendMail({ from: FROM_EMAIL, to, subject, html });\r\n}\r\n\r\nfunction renderUserTemplate(name: string) {\r\n  const logo = `${SITE_URL}/images/ryan-profile-red.jpg`;\r\n  return `\r\n  <table role=\"presentation\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"background:#0b0f16;color:#fff;padding:24px;font-family:Inter,system-ui,Arial,sans-serif\">\r\n    <tr>\r\n      <td align=\"center\">\r\n        <table role=\"presentation\" width=\"600\" cellpadding=\"0\" cellspacing=\"0\" style=\"max-width:600px;background:#111827;border-radius:16px;overflow:hidden\">\r\n          <tr>\r\n            <td style=\"background:#ef4444;padding:20px 24px;text-align:center\">\r\n              <img src=\"${logo}\" alt=\"Ryan Moshi\" width=\"56\" height=\"56\" style=\"border-radius:12px;display:block;margin:0 auto 8px\" />\r\n              <div style=\"font-size:18px;font-weight:700;letter-spacing:.3px;margin:0;color:#fff\">Ryan Moshi</div>\r\n            </td>\r\n          </tr>\r\n          <tr>\r\n            <td style=\"padding:24px 24px 8px\">\r\n              <h1 style=\"margin:0 0 10px;font-size:22px;font-weight:700;letter-spacing:.3px;color:#fff\">Thank you, ${name}!</h1>\r\n              <p style=\"margin:0 0 16px;opacity:.9;line-height:1.6;color:#e5e7eb\">Your message has been received. Iâ€™ll get back to you shortly. In the meantime, feel free to explore recent work and capabilities.</p>\r\n            </td>\r\n          </tr>\r\n          <tr>\r\n            <td style=\"padding:8px 24px 24px;text-align:center\">\r\n              <a href=\"${SITE_URL}\" style=\"display:inline-block;background:#ef4444;color:#fff;text-decoration:none;padding:12px 18px;border-radius:10px;font-weight:600\">Visit Portfolio</a>\r\n            </td>\r\n          </tr>\r\n        </table>\r\n      </td>\r\n    </tr>\r\n  </table>`;\r\n}\r\n\r\nfunction renderOwnerTemplate(payload: any) {\r\n  const entries = Object.entries(payload) as [string, string][];\r\n  const rows = entries\r\n    .map(([k, v]) => `<tr><td style=\"padding:6px 12px;background:#0b0f16;color:#9ca3af\">${k}</td><td style=\"padding:6px 12px;background:#111827;color:#fff\">${(v||\"\")\r\n      .toString()\r\n      .replace(/</g, \"&lt;\")}</td></tr>`) \r\n    .join(\"\");\r\n  const logo = `${SITE_URL}/images/ryan-profile-red.jpg`;\r\n  const retrosoft = `${SITE_URL}/images/retrosoft-logo.png`;\r\n  const retroworld = `${SITE_URL}/images/retroworld-logo.png`;\r\n  const dropex = `${SITE_URL}/images/dropex-logo-blue.png`;\r\n  return `\r\n  <table role=\"presentation\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"background:#0b0f16;color:#fff;padding:24px;font-family:Inter,system-ui,Arial,sans-serif\">\r\n    <tr><td align=\"center\">\r\n      <table role=\"presentation\" width=\"700\" cellpadding=\"0\" cellspacing=\"0\" style=\"max-width:700px;background:#111827;border-radius:16px;overflow:hidden\">\r\n        <tr>\r\n          <td style=\"background:#ef4444;padding:16px 20px;text-align:center\">\r\n            <img src=\"${logo}\" width=\"44\" height=\"44\" alt=\"Ryan Moshi\" style=\"border-radius:10px;display:block;margin:0 auto 8px\" />\r\n            <div style=\"font-weight:700;color:#fff;margin:0\">New Contact Form Submission</div>\r\n          </td>\r\n        </tr>\r\n        <tr><td style=\"padding:16px 20px\">\r\n          <table role=\"presentation\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"border-collapse:collapse\">\r\n            ${rows}\r\n          </table>\r\n        </td></tr>\r\n        <tr>\r\n          <td style=\"padding:12px 20px 20px;text-align:center;opacity:.9\">\r\n            <table role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" style=\"margin:0 auto\">\r\n              <tr>\r\n                <td style=\"padding:0 6px\"><img src=\"${retrosoft}\" width=\"28\" height=\"28\" alt=\"Retrosoft\" style=\"border-radius:6px;display:block\" /></td>\r\n                <td style=\"padding:0 6px\"><img src=\"${retroworld}\" width=\"28\" height=\"28\" alt=\"RetroWorld Studios\" style=\"border-radius:6px;display:block\" /></td>\r\n                <td style=\"padding:0 6px\"><img src=\"${dropex}\" width=\"28\" height=\"28\" alt=\"DropEx Logistics\" style=\"border-radius:6px;display:block\" /></td>\r\n              </tr>\r\n            </table>\r\n          </td>\r\n        </tr>\r\n      </table>\r\n    </td></tr>\r\n  </table>`;\r\n}\r\n\r\nexport async function POST(req: Request) {\r\n  try {\r\n    // Debug environment variables\r\n    console.log(\"Environment Variables Debug:\");\r\n    console.log(\"SMTP_USER:\", process.env.SMTP_USER ? \"Set\" : \"Missing\");\r\n    console.log(\"SMTP_PASS:\", process.env.SMTP_PASS ? \"Set\" : \"Missing\");\r\n    console.log(\"SMTP_HOST:\", process.env.SMTP_HOST);\r\n    console.log(\"SMTP_PORT:\", process.env.SMTP_PORT);\r\n    console.log(\"MAIL_FROM:\", process.env.MAIL_FROM);\r\n    \r\n    const data = await req.json();\r\n    const { name, email, projectName, projectType, budget, timeline, description, source } = data;\r\n\r\n    // Enhanced validation\r\n    if (!name || !email || !projectName || !projectType || !description) {\r\n      return NextResponse.json({ \r\n        error: \"Missing required fields. Please fill in all required fields.\" \r\n      }, { status: 400 });\r\n    }\r\n\r\n    // Email validation\r\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n    if (!emailRegex.test(email)) {\r\n      return NextResponse.json({ \r\n        error: \"Please provide a valid email address.\" \r\n      }, { status: 400 });\r\n    }\r\n\r\n    // Prepare enhanced data for email templates\r\n    const enhancedData = {\r\n      name: name.trim(),\r\n      email: email.trim(),\r\n      projectName: projectName.trim(),\r\n      projectType: projectType,\r\n      budget: budget ? `$${Number(budget).toLocaleString()}` : 'Not specified',\r\n      timeline: timeline ? `${timeline} months` : 'Not specified',\r\n      description: description.trim(),\r\n      source: source || 'Not specified',\r\n      submittedAt: new Date().toLocaleString()\r\n    };\r\n\r\n    await Promise.all([\r\n      sendEmail(email, \"Thanks for reaching out to Ryan Moshi\", renderUserTemplate(name)),\r\n      sendEmail(NOTIFY_EMAIL, \"New Project Inquiry - Portfolio Contact\", renderOwnerTemplate(enhancedData)),\r\n    ]);\r\n\r\n    return NextResponse.json({ ok: true });\r\n  } catch (err: any) {\r\n    console.error('Contact form error:', err);\r\n    return NextResponse.json({ \r\n      error: err?.message || \"Failed to send message. Please try again later.\" \r\n    }, { status: 500 });\r\n  }\r\n}\r\n\r\n\r\n"],"names":[],"mappings":"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","debugId":null}}]
}